@{
	ViewBag.Title = "Home Page";
}

<div class="centered">
<h1>Find a place to play.</h1>
<h2>Find an instrument for public use, for rent, or for sale.</h2>
<p>
	Since 2011, Legato Network has connected musicians around the world to create a network for information exchange &mdash; a connected network.
</p>

<div>
	<input id="address" type="textbox" value="" title="find address" />
	<input type="button" value="Zoom" id="zoomButton" />
</div>
<!--<div id="mapCanvas" style="z-index:22; height:400px;width:930px;margin:10px;"></div>-->
<div id="mapCanvas" style="z-index:22; height:400px;width:900px;margin:10px;" class="span-22 prepend-1 last"></div>
</div>

@section ScriptContentAtEndOfBody {

<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
<script src="/static/js/map.js"></script>
<script>
	var points = [];

	$.getJSON("@Url.Action("Map","Instruments")",
	  function (data) {
	  //alert(data.Data[0].lat);
		//$.each(data.Data, function(i){
			//alert("i = "+i);
			//alert("item = "+item);
		//	Legato.map.markLocations(i);
		//});
		//  alert(data);
		//  alert(data.items[0]);
		  points = data;
		  alert(points);
	  });

	Legato.map.init();

	google.maps.event.addListenerOnce(Legato.map.map, 'tilesloaded', function () {
		alert("about to marklocations")
			//$.getJSON("@Url.Action("Map","Instruments")",
	  //function (data) {
		//alert(data[0]);
		//alert(data[0].lat);
		//$.each(data, function(i,item){
		//	alert("i = "+i);
		//	alert("item = "+item);
		//	alert(item.lat);
		//	Legato.map.markLocations(item);
		//});
		//  alert(data);
		//  alert(data.items[0]);
		//  points = data;
	  //});
		Legato.map.markLocations(points);
	});
	
	$('#zoomButton').click(function() {
		Legato.map.codeAddress();
	});

	// Handle ENTER keypress
	$('#address').keypress(function(e) {
		var code = (e.keyCode ? e.keyCode : e.which);
		if(code == 13) { //Keycode for ENTER key
			//Do something
			Legato.map.codeAddress();
		}
	});
</script>
}