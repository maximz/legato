@model Legato.ViewModels.ComposeViewModel
@{
	ViewBag.Title = "Compose Message";
	ViewBag.revNum = Legato.Current.RevNumber();
}

@section ScriptContentAtEndOfBody {
<script src="@Url.Content("~/static/js/jquery.validate.min.js")?@ViewBag.revNum" type="text/javascript"></script>
<script src="@Url.Content("~/static/js/jquery.validate.unobtrusive.min.js")?@ViewBag.revNum" type="text/javascript"></script>

<script>

(function () {
				var converter1 = Markdown.getSanitizingConverter();
				var editor1 = new Markdown.Editor(converter1);
				editor1.run();
})();

</script>
}

<section id="compose">
  <div class="page-header">
	<h1>Compose <small>Write a new message</small></h1>
  </div>
	  <!-- Example row of columns -->
	  <div class="row">
		<div class="span16">

@using (Html.BeginForm())
{
	@Html.ValidationSummary(true)
	<fieldset>
			<legend>Message details</legend>
			
			<div class="clearfix">
				@Html.LabelFor(model => model.Subject)
			<div class="input">
				@Html.TextBoxFor(model => model.Subject)
				@Html.ValidationMessageFor(model => model.Subject)
			</div></div>
			
			<div class="clearfix">
				@Html.LabelFor(model => model.UserName)
			<div class="input">
				@Html.TextBoxFor(model => model.UserName)
				@Html.ValidationMessageFor(model => model.UserName)
			</div></div>

			<div class="clearfix">
				@Html.LabelFor(model => model.Markdown)
			<div class="input wmd-panel">
				@Html.ValidationMessageFor(model => model.Markdown)
				<div id="wmd-button-bar" class="wmd-panel"></div>
				@Html.TextAreaFor(model => model.Markdown, new { @class = "wmd-input", id = "wmd-input" })
				<div id="wmd-preview" class="wmd-preview wmd-panel"></div>
			</div></div>

			</fieldset>
		  <div class="actions well">
			<input type="submit" class="btn primary large" value="Send" />&nbsp;<button type="reset" onclick="window.history.go(-1);" class="btn">Cancel</button>
		  </div>
		
}
		</div>
	  </div> <!-- /row -->
	  
	</section>